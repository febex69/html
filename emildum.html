<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Crazy Funny Image Editor</title>
<style>
body {
  font-family: sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 20px;
}
canvas {
  margin-top: 20px;
  border: 2px solid black;
}
button {
  margin: 5px;
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
}
</style>
</head>
<body>

<h1>Crazy Funny Image Editor</h1>
<input type="file" id="upload" accept="image/*"><br>
<canvas id="canvas" width="500" height="500"></canvas><br>

<!-- Funny effect buttons -->
<button onclick="invertColors()">Invert Colors</button>
<button onclick="pixelate()">Pixelate</button>
<button onclick="addScribbles()">Scribbles</button>
<button onclick="randomTint()">Random Tint</button>
<button onclick="stretch()">Stretch</button>
<button onclick="flip()">Flip Horizontally</button>
<button onclick="swirl()">Swirl</button>
<button onclick="resetImage()">Reset</button>

<script>
const upload = document.getElementById('upload');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let originalImage = null;

upload.addEventListener('change', (e) => {
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(event){
      const img = new Image();
      img.onload = function(){
        // Fit image into canvas
        const scale = Math.min(500/img.width, 500/img.height);
        canvas.width = img.width * scale;
        canvas.height = img.height * scale;
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        originalImage = ctx.getImageData(0, 0, canvas.width, canvas.height);
      }
      img.src = event.target.result;
    }
    reader.readAsDataURL(file);
  }
});

// Effects
function invertColors(){
  const imageData = ctx.getImageData(0,0,canvas.width,canvas.height);
  for(let i=0;i<imageData.data.length;i+=4){
    imageData.data[i] = 255 - imageData.data[i];
    imageData.data[i+1] = 255 - imageData.data[i+1];
    imageData.data[i+2] = 255 - imageData.data[i+2];
  }
  ctx.putImageData(imageData,0,0);
}

function pixelate(){
  const size = 10;
  const w = canvas.width;
  const h = canvas.height;
  const imageData = ctx.getImageData(0,0,w,h);
  for(let y=0; y<h; y+=size){
    for(let x=0; x<w; x+=size){
      const i = ((y*w)+x)*4;
      const r = imageData.data[i];
      const g = imageData.data[i+1];
      const b = imageData.data[i+2];
      for(let yy=0; yy<size; yy++){
        for(let xx=0; xx<size; xx++){
          const j = ((y+yy)*w + (x+xx))*4;
          if(j < imageData.data.length){
            imageData.data[j] = r;
            imageData.data[j+1] = g;
            imageData.data[j+2] = b;
          }
        }
      }
    }
  }
  ctx.putImageData(imageData,0,0);
}

function addScribbles(){
  for(let i=0;i<50;i++){
    ctx.strokeStyle = `hsl(${Math.random()*360},100%,50%)`;
    ctx.lineWidth = Math.random()*5+1;
    ctx.beginPath();
    ctx.moveTo(Math.random()*canvas.width, Math.random()*canvas.height);
    ctx.lineTo(Math.random()*canvas.width, Math.random()*canvas.height);
    ctx.stroke();
  }
}

function randomTint(){
  const imageData = ctx.getImageData(0,0,canvas.width,canvas.height);
  const rTint = Math.random()*100;
  const gTint = Math.random()*100;
  const bTint = Math.random()*100;
  for(let i=0;i<imageData.data.length;i+=4){
    imageData.data[i] = Math.min(imageData.data[i]+rTint, 255);
    imageData.data[i+1] = Math.min(imageData.data[i+1]+gTint, 255);
    imageData.data[i+2] = Math.min(imageData.data[i+2]+bTint, 255);
  }
  ctx.putImageData(imageData,0,0);
}

function stretch(){
  const imageData = ctx.getImageData(0,0,canvas.width,canvas.height);
  const stretched = ctx.createImageData(canvas.width, canvas.height);
  for(let y=0; y<canvas.height; y++){
    for(let x=0; x<canvas.width; x++){
      const i = (y*canvas.width + x)*4;
      const newX = Math.min(canvas.width-1, Math.floor(x + 20*Math.sin(y/20)));
      const newY = Math.min(canvas.height-1, y);
      const j = (newY*canvas.width + newX)*4;
      stretched.data[j] = imageData.data[i];
      stretched.data[j+1] = imageData.data[i+1];
      stretched.data[j+2] = imageData.data[i+2];
      stretched.data[j+3] = imageData.data[i+3];
    }
  }
  ctx.putImageData(stretched,0,0);
}

function flip(){
  const imageData = ctx.getImageData(0,0,canvas.width,canvas.height);
  const flipped = ctx.createImageData(canvas.width, canvas.height);
  for(let y=0; y<canvas.height; y++){
    for(let x=0; x<canvas.width; x++){
      const i = (y*canvas.width + x)*4;
      const j = (y*canvas.width + (canvas.width-1-x))*4;
      flipped.data[j] = imageData.data[i];
      flipped.data[j+1] = imageData.data[i+1];
      flipped.data[j+2] = imageData.data[i+2];
      flipped.data[j+3] = imageData.data[i+3];
    }
  }
  ctx.putImageData(flipped,0,0);
}

function swirl(){
  const imageData = ctx.getImageData(0,0,canvas.width,canvas.height);
  const w = canvas.width;
  const h = canvas.height;
  const cx = w/2;
  const cy = h/2;
  const swirled = ctx.createImageData(w,h);
  for(let y=0;y<h;y++){
    for(let x=0;x<w;x++){
      const dx = x - cx;
      const dy = y - cy;
      const r = Math.sqrt(dx*dx + dy*dy);
      const angle = Math.atan2(dy, dx) + 0.05*r;
      const sx = Math.floor(cx + r * Math.cos(angle));
      const sy = Math.floor(cy + r * Math.sin(angle));
      if(sx>=0 && sx<w && sy>=0 && sy<h){
        const src = (sy*w + sx)*4;
        const dest = (y*w + x)*4;
        swirled.data[dest] = imageData.data[src];
        swirled.data[dest+1] = imageData.data[src+1];
        swirled.data[dest+2] = imageData.data[src+2];
        swirled.data[dest+3] = imageData.data[src+3];
      }
    }
  }
  ctx.putImageData(swirled,0,0);
}

function resetImage(){
  if(originalImage){
    ctx.putImageData(originalImage,0,0);
  }
}
</script>

</body>
</html>
